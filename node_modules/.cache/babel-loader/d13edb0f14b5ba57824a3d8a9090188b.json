{"ast":null,"code":"import _slicedToArray from\"D:/\\u524D\\u7AEF/\\u9879\\u76EE/cms-hcj/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{/*  Avatar, */Button,List,Skeleton,Pagination,message}from'antd';import moment from'moment';import React,{useEffect,useState}from'react';import{ArticlesApi,removeArticleApi}from'../request/api';import{useNavigate}from'react-router-dom';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function ListList(){var navigate=useNavigate();var _useState=useState([]),_useState2=_slicedToArray(_useState,2),list=_useState2[0],setList=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),total=_useState4[0],setTotal=_useState4[1];var _useState5=useState(0),_useState6=_slicedToArray(_useState5,2),current=_useState6[0],setCurrent=_useState6[1];var _useState7=useState(0),_useState8=_slicedToArray(_useState7,2),pageSize=_useState8[0],setPageSize=_useState8[1];var _useState9=useState(0),_useState10=_slicedToArray(_useState9,2),flash=_useState10[0],setFlash=_useState10[1];useEffect(function(){getList(current,pageSize);},[current,pageSize,flash]);var getList=function getList(current,pageSize){ArticlesApi({num:current,count:pageSize}).then(function(res){// console.log(res)\nif(res.errCode===0){var _res$data=res.data,arr=_res$data.arr,_total=_res$data.total,num=_res$data.num,count=_res$data.count;setTotal(_total);setList(arr);setCurrent(num);setPageSize(count);}});};var onChange=function onChange(page,pageSize){getList(page,pageSize);};return/*#__PURE__*/_jsxs(\"div\",{className:\"list_table\",style:{padding:'20px'},children:[/*#__PURE__*/_jsx(List,{className:\"demo-loadmore-list\",itemLayout:\"horizontal\",dataSource:list,renderItem:function renderItem(item){return/*#__PURE__*/_jsx(List.Item,{actions:[/*#__PURE__*/_jsx(Button,{type:\"primary\",onClick:function onClick(){return navigate('/edit/'+item.id);},children:\"\\u7F16\\u8F91\"}),/*#__PURE__*/_jsx(Button,{type:\"primary\",onClick:function onClick(){removeArticleApi({id:item.id}).then(function(res){if(res.errCode===0){message.success(res.message);// 刷新页面\n// 1 页面重载\n// window.reload\n// 2 重新请求数据\n// getList(1)\n// 3 设置一个变量监控\nsetFlash(flash+1);}else{message.error(res.message);}});},danger:true,children:\"\\u5220\\u9664\"})],children:/*#__PURE__*/_jsxs(Skeleton,{title:false,loading:item.loading,active:true,children:[/*#__PURE__*/_jsx(List.Item.Meta,{title:/*#__PURE__*/_jsx(\"a\",{href:\"/#\",children:item.title}),description:item.subTitle}),/*#__PURE__*/_jsx(\"div\",{children:moment(item.date).format('YYYY-MM-DD hh:mm:ss')})]})});}}),/*#__PURE__*/_jsx(Pagination,{defaultCurrent:1,total:total,pageSize:pageSize,style:{float:'right',marginTop:'20px'},onChange:onChange})]});}","map":{"version":3,"names":["Button","List","Skeleton","Pagination","message","moment","React","useEffect","useState","ArticlesApi","removeArticleApi","useNavigate","ListList","navigate","list","setList","total","setTotal","current","setCurrent","pageSize","setPageSize","flash","setFlash","getList","num","count","then","res","errCode","data","arr","onChange","page","padding","item","id","success","error","loading","title","subTitle","date","format","float","marginTop"],"sources":["D:/前端/项目/cms-hcj/src/pages/ListList.jsx"],"sourcesContent":["import {/*  Avatar, */ Button, List, Skeleton, Pagination, message } from 'antd';\r\nimport moment from 'moment';\r\nimport React, { useEffect, useState } from 'react';\r\nimport { ArticlesApi ,removeArticleApi} from '../request/api';\r\nimport { useNavigate } from 'react-router-dom';\r\n\r\n\r\nexport default function ListList() {\r\n\r\n  const navigate = useNavigate()\r\n  const [list, setList] = useState([]);\r\n  const [total, setTotal] = useState(0)\r\n  const [current, setCurrent] = useState(0)\r\n  const [pageSize, setPageSize] = useState(0)\r\n\r\n  const [flash,setFlash] = useState(0) \r\n  useEffect(() => {\r\n    getList(current, pageSize)\r\n\r\n  }, [current,pageSize,flash])\r\n\r\n\r\n  const getList = (current, pageSize) => {\r\n    ArticlesApi({\r\n      num: current,\r\n      count: pageSize\r\n    }).then(res => {\r\n      // console.log(res)\r\n      if (res.errCode === 0) {\r\n        let { arr, total, num, count } = res.data\r\n\r\n        setTotal(total)\r\n        setList(arr)\r\n        setCurrent(num)\r\n        setPageSize(count)\r\n      }\r\n    })\r\n  }\r\n  const onChange = (page, pageSize) => {\r\n    getList(page, pageSize)\r\n  }\r\n\r\n\r\n\r\n\r\n  return (\r\n    <div className='list_table' style={{\r\n      padding: '20px'\r\n    }}>\r\n      <List\r\n        className=\"demo-loadmore-list\"\r\n        itemLayout=\"horizontal\"\r\n        dataSource={list}\r\n        renderItem={(item) => {\r\n          return (\r\n            <List.Item\r\n              actions={[\r\n              <Button type='primary' onClick={() => navigate('/edit/'+item.id)}>编辑</Button>, \r\n              <Button type='primary' onClick={() => { \r\n                removeArticleApi({id:item.id}).then(res=>{\r\n                  if(res.errCode===0){\r\n                    message.success(res.message)\r\n                    // 刷新页面\r\n                    // 1 页面重载\r\n                    // window.reload\r\n                    // 2 重新请求数据\r\n                    // getList(1)\r\n                    // 3 设置一个变量监控\r\n                    setFlash(flash+1)\r\n                  }else{\r\n                    message.error(res.message)\r\n                  }\r\n                })\r\n              }} danger>删除</Button>\r\n            ]}\r\n            >\r\n              <Skeleton\r\n                title={false}\r\n                loading={item.loading}\r\n                active>\r\n                <List.Item.Meta\r\n                  title={<a href=\"/#\">{item.title}</a>}\r\n                  description={item.subTitle}\r\n                />\r\n                <div>{\r\n                  moment(item.date).format('YYYY-MM-DD hh:mm:ss')\r\n                }</div>\r\n              </Skeleton>\r\n            </List.Item>\r\n          )\r\n        }\r\n        }\r\n      />\r\n      <Pagination\r\n        defaultCurrent={1}\r\n        total={total}\r\n        pageSize={pageSize}\r\n        style={{\r\n          float: 'right',\r\n          marginTop: '20px'\r\n        }}\r\n        onChange={onChange} />\r\n    </div>\r\n  )\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}