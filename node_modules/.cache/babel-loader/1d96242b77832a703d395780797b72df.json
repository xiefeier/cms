{"ast":null,"code":"import _slicedToArray from\"D:/\\u524D\\u7AEF/\\u9879\\u76EE/cms-hcj/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect}from'react';import{Link}from'react-router-dom';import'./less/list_table.less';import{Space,Table,/* Tag,  */Button}from'antd';import{useState}from'react';import{ArticlesApi,removeArticleApi}from'../request/api';import MixTitle from'../components/MixTitle';import moment from'moment';import{useNavigate}from'react-router-dom';import{message}from'antd';// const data = [{\n//     key: '1',\n//     name: 'John Brown',\n//     date: '2022-10-31 15:07:25',\n// }]\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function ListTable(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),rows=_useState2[0],setRows=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),flash=_useState4[0],setFlash=_useState4[1];var navigate=useNavigate();// 分页\nvar _useState5=useState({current:1,pageSize:5}),_useState6=_slicedToArray(_useState5,2),pagination=_useState6[0],setPagination=_useState6[1];// 封装请求\nvar getArticleList=function getArticleList(cunrrent,pageSize){ArticlesApi({num:cunrrent,count:pageSize}).then(function(res){var _res$data=res.data,num=_res$data.num,count=_res$data.count,total=_res$data.total;setPagination({cunrrent:num,pageSize:count,total:total});// res.data.total\n// 深拷贝\nvar newarr=JSON.parse(JSON.stringify(res.data.arr));var viewarticles=[];newarr.map(function(item){console.log(item);// item.date = moment(item.date).format('YYYY-MM-DD hh:mm:ss')\n// item.mixTitle = `<div>\n//     <Link className='table_title' to='/'>${item.title }</Link>\n//     <p style={{ color: \"#999\" }}>\n//     ${item.subTitle }\n//     </p>\n// </div>`\n// 组件化开发\nvar obj={key:item.id,date:moment(item.date).format('YYYY-MM-DD hh:mm:ss'),mixTitle:/*#__PURE__*/_jsx(MixTitle,{id:item.id,title:item.title,subTitle:item.subTitle})};viewarticles.push(obj);});setRows(viewarticles);});};var onChange=function onChange(pagination){// console.log(pagination)\ngetArticleList(pagination.current,pagination.pageSize);};useEffect(function(){// console.log(pagination)\ngetArticleList(pagination.current,pagination.pageSize);},[flash]);var columns=[{dataIndex:'mixTitle',key:'mixTitle',width:'60%',render:function render(text){return text;}// <>\n//     <Link className='table_title' to='/'>{ }</Link>\n//     <p style={{ color: \"#999\" }}>\n//         {text}\n//     </p>\n// </>\n},{dataIndex:'date',key:'date'},{key:'action',render:function render(text){return/*#__PURE__*/_jsxs(Space,{size:\"middle\",children:[/*#__PURE__*/_jsx(Button,{type:\"primary\",onClick:function onClick(){return navigate('/edit/'+text.key);},children:\"\\u7F16\\u8F91\"}),/*#__PURE__*/_jsx(Button,{type:\"primary\",onClick:function onClick(){removeArticleApi({id:text.key}).then(function(res){if(res.errCode===0){message.success(res.message);setFlash(flash+1);// getArticleList(pagination.current, pagination.pageSize)\n}else{message.error(res.message);}});},danger:true,children:\"\\u5220\\u9664\"})]});}}];return/*#__PURE__*/_jsx(\"div\",{className:\"list_table\",children:/*#__PURE__*/_jsx(Table,{pagination:pagination,showHeader:false,columns:columns,dataSource:rows,onChange:onChange})});}","map":{"version":3,"names":["React","useEffect","Link","Space","Table","Button","useState","ArticlesApi","removeArticleApi","MixTitle","moment","useNavigate","message","ListTable","rows","setRows","flash","setFlash","navigate","current","pageSize","pagination","setPagination","getArticleList","cunrrent","num","count","then","res","data","total","newarr","JSON","parse","stringify","arr","viewarticles","map","item","console","log","obj","key","id","date","format","mixTitle","title","subTitle","push","onChange","columns","dataIndex","width","render","text","errCode","success","error"],"sources":["D:/前端/项目/cms-hcj/src/pages/ListTable.jsx"],"sourcesContent":["import React, { useEffect } from 'react'\r\nimport { Link } from 'react-router-dom';\r\nimport './less/list_table.less'\r\nimport { Space, Table, /* Tag,  */Button } from 'antd';\r\nimport { useState } from 'react';\r\nimport { ArticlesApi,removeArticleApi } from '../request/api';\r\nimport MixTitle from '../components/MixTitle';\r\nimport moment from 'moment';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { message } from 'antd';\r\n// const data = [{\r\n//     key: '1',\r\n//     name: 'John Brown',\r\n//     date: '2022-10-31 15:07:25',\r\n// }]\r\n\r\nexport default function ListTable() {\r\n    const [rows, setRows] = useState([])\r\n    const [flash, setFlash] = useState(0)\r\n\r\n    const navigate = useNavigate()\r\n    // 分页\r\n    const [pagination, setPagination] = useState({\r\n        current: 1,\r\n        pageSize: 5\r\n    })\r\n\r\n    // 封装请求\r\n    const getArticleList = (cunrrent, pageSize) => {\r\n        ArticlesApi({\r\n            num: cunrrent,\r\n            count: pageSize\r\n        }).then(res => {\r\n            let { num, count, total } = res.data\r\n            setPagination({\r\n                cunrrent: num,\r\n                pageSize: count,\r\n                total: total\r\n            })\r\n            // res.data.total\r\n            // 深拷贝\r\n            let newarr = JSON.parse(JSON.stringify(res.data.arr))\r\n            let viewarticles = []\r\n            newarr.map(item => {\r\n                console.log(item)\r\n\r\n                // item.date = moment(item.date).format('YYYY-MM-DD hh:mm:ss')\r\n                // item.mixTitle = `<div>\r\n                //     <Link className='table_title' to='/'>${item.title }</Link>\r\n                //     <p style={{ color: \"#999\" }}>\r\n                //     ${item.subTitle }\r\n                //     </p>\r\n                // </div>`\r\n\r\n                // 组件化开发\r\n                let obj = {\r\n                    key: item.id,\r\n                    date: moment(item.date).format('YYYY-MM-DD hh:mm:ss'),\r\n                    mixTitle: <MixTitle id={item.id} title={item.title} subTitle={item.subTitle}></MixTitle>\r\n                }\r\n                viewarticles.push(obj)\r\n            })\r\n\r\n\r\n            setRows(viewarticles)\r\n\r\n        })\r\n    }\r\n\r\n    const onChange = (pagination) => {\r\n        // console.log(pagination)\r\n        getArticleList(pagination.current, pagination.pageSize)\r\n    }\r\n    useEffect(() => {\r\n        // console.log(pagination)\r\n        getArticleList(pagination.current, pagination.pageSize)\r\n    }, [flash])\r\n\r\n    const columns = [\r\n        {\r\n            dataIndex: 'mixTitle',\r\n            key: 'mixTitle',\r\n            width: '60%',\r\n            render: (text) =>\r\n                text\r\n            // <>\r\n            //     <Link className='table_title' to='/'>{ }</Link>\r\n            //     <p style={{ color: \"#999\" }}>\r\n            //         {text}\r\n            //     </p>\r\n            // </>\r\n            ,\r\n        },\r\n        {\r\n            dataIndex: 'date',\r\n            key: 'date',\r\n        },\r\n        {\r\n            key: 'action',\r\n            render: (text) => {\r\n                return (\r\n                    <Space size=\"middle\">\r\n                        <Button type='primary' onClick={() => navigate('/edit/' + text.key)}>编辑</Button>\r\n                        <Button type='primary' onClick={() => {\r\n                            removeArticleApi({ id: text.key }).then(res => {\r\n                                if (res.errCode === 0) {\r\n                                    message.success(res.message)\r\n                                    setFlash(flash + 1)\r\n                                    // getArticleList(pagination.current, pagination.pageSize)\r\n                                } else {\r\n                                    message.error(res.message)\r\n                                }\r\n                            })\r\n                        }} danger>删除</Button>\r\n                    </Space>\r\n                )\r\n            },\r\n        },\r\n    ];\r\n\r\n    return (\r\n        <div className='list_table'>\r\n            <Table pagination={pagination}\r\n                showHeader={false}\r\n                columns={columns}\r\n                dataSource={rows}\r\n                onChange={onChange}\r\n            />\r\n        </div>\r\n    )\r\n}\r\n\r\n\r\n\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}